<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Vit mobil 300×534 – auto+manuell scroll, smal bottenram</title>
<style>
  :root{
    --phone-w: 300px;
    --phone-h: 534px;
    --screen-lr: 8px;      /* vänster/höger ram */
    --screen-top: 24px;    /* topp-ram */
    --screen-bottom: 8px;  /* botten-ram = lika smal som vänster/höger */
    --radius-phone: 28px;
    --radius-screen: 20px;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body{
    margin:0;
    background:transparent;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    display:grid; place-items:center;
    overflow:hidden; /* undvik inre scrollbars i iframen */
  }
  .stage{ display:grid; place-items:center; position:relative; }

  .phone{
    position:relative;
    width:var(--phone-w); height:var(--phone-h);
    background:#fff; border-radius:var(--radius-phone);
    box-shadow: inset 0 0 0 1px #e0e0e0; overflow:hidden;
  }
  .notch{
    position:absolute; top:6px; left:50%; transform:translateX(-50%);
    width:90px; height:14px; background:#eee; border-radius:0 0 8px 8px;
    box-shadow: inset 0 0 2px rgba(0,0,0,.12); z-index:2;
  }
  .screen{
    position:absolute;
    top: var(--screen-top);
    bottom: var(--screen-bottom);
    left: var(--screen-lr);
    right: var(--screen-lr);
    border-radius: var(--radius-screen);
    overflow:hidden; background:#fff;
    box-shadow: inset 0 0 18px rgba(0,0,0,.10);
    touch-action:none; cursor:grab; user-select:none; -webkit-user-select:none;
  }
  .screen.dragging{ cursor:grabbing; }
  .longshot{
    width:100%; height:auto; display:block;
    transform:translateY(0); opacity:1;
    will-change: transform, opacity;
    user-select:none; -webkit-user-drag:none; pointer-events:none;
  }
</style>
</head>
<body>
  <div class="stage">
    <div class="phone" role="region" aria-label="Telefonram med förhandsvisning">
      <div class="notch"></div>
      <div class="screen" id="screen" tabindex="0" aria-label="Skärmområde med rullbar förhandsvisning">
        <img id="longshot" class="longshot"
             src="https://sleo1.github.io/scroll-demo/startsida2024-2.jpg"
             alt="Förhandsvisning av lång sida">
      </div>
    </div>
  </div>

<script>
(() => {
  // === Auto-scroll konfig (stegvis) ===
  const CONFIG = {
    STEP_DURATION: 4000,
    STEP_GAP:      200,
    TOP_PAUSE:     600,
    BOTTOM_PAUSE:  600,
    FADE_OUT_DUR:  500,
    FADE_IN_DUR:   350,
    RESUME_DELAY:  1500,  // inaktivitet efter manuell input innan auto återupptas
    WHEEL_SPEED:   1.0
  };

  const img    = document.getElementById('longshot');
  const screen = document.getElementById('screen');

  let running = false;
  let pausedByUser = false;   // temporär paus under manuell interaktion
  let resumeTimer = null;

  const sleep=ms=>new Promise(r=>setTimeout(r,ms));
  const setY=y=>{ img.style.transform=`translateY(${-Math.max(0,Math.round(y))}px)`; };
  const transition=(props,dur,easing='ease')=>{ img.style.transition=props.map(p=>`${p} ${dur}ms ${easing}`).join(', '); };
  const clearTransition=()=>{ img.style.transition='none'; };

  function deltaPx(){
    if(!img.naturalWidth || !img.naturalHeight) return 0;
    const scale = screen.clientWidth / img.naturalWidth;
    const imgH  = img.naturalHeight * scale;
    return Math.max(0, imgH - screen.clientHeight);
  }
  function currentY(){
    const m = /translateY\((-?\d+)px\)/.exec(img.style.transform);
    return m ? Math.max(0, -parseInt(m[1],10)) : 0;
  }
  const clamp=(v,a,b)=>Math.min(b,Math.max(a,v));

  function tempPauseAuto(){
    pausedByUser = true;
    clearTransition();
    if(resumeTimer) clearTimeout(resumeTimer);
    resumeTimer = setTimeout(()=>{ pausedByUser = false; }, CONFIG.RESUME_DELAY);
  }

  async function animateStep(fromY,toY){
    clearTransition(); setY(fromY); await sleep(20);
    transition(['transform'], CONFIG.STEP_DURATION, 'ease-in-out');
    setY(toY); await sleep(CONFIG.STEP_DURATION); clearTransition(); postSize();
  }
  async function fadeReset(){
    clearTransition(); await sleep(20);
    transition(['opacity'], CONFIG.FADE_OUT_DUR, 'ease'); img.style.opacity='0';
